<template>
  <div class="manual-container">
    <!-- ページヘッダー -->
    <div class="mb-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-bold text-gray-900 dark:text-white">
            ご利用マニュアル
          </h1>
          <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
            YadOPERAの操作方法・機能説明
          </p>
        </div>
        <!-- モバイル用目次トグルボタン -->
        <button
          @click="isMobileTocOpen = !isMobileTocOpen"
          class="lg:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"
          aria-label="目次を開く"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            />
          </svg>
        </button>
      </div>
    </div>

    <!-- モバイル用目次（折りたたみ） -->
    <div
      v-if="isMobileTocOpen"
      class="lg:hidden mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-lg"
    >
      <ManualToc :sections="sections" :isMobile="true" />
    </div>

    <!-- メインコンテンツエリア -->
    <div class="flex gap-6">
      <!-- 目次（タブレット・デスクトップ） -->
      <aside class="hidden md:block md:w-[200px] lg:w-64 flex-shrink-0">
        <ManualToc :sections="sections" />
      </aside>

      <!-- マニュアル本文 -->
      <main class="flex-1 md:max-w-3xl lg:max-w-[800px]">
        <ManualContent :sections="sections" />
      </main>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import ManualToc from '@/components/admin/ManualToc.vue'
import ManualContent from '@/components/admin/ManualContent.vue'

// モバイル用目次開閉状態
const isMobileTocOpen = ref(false)

// マニュアルセクション定義（12章構成）
const sections = ref([
  {
    id: 'intro',
    title: '第1章 はじめに',
    subsections: [
      {
        id: 'intro-about',
        title: '1.1 YadOPERAとは',
        content: `YadOPERAは、宿泊施設管理者がゲストの質問にAIで自動応答するシステムです。

**システムの機能**:
- ゲストはQRコードを読み取ってアクセスし、チャット形式で質問できます
- 管理者はFAQを登録し、AIが自動的に回答します
- スタッフ不在時間帯の質問は対応キューに表示され、後で確認・対応できます

**管理者ができること**:
- FAQの登録・編集・削除
- QRコードの発行・ダウンロード
- ダッシュボードで利用状況の確認
- スタッフ不在時間帯対応キューの確認・対応
- 施設情報の設定（チェックイン/アウト時間、WiFi情報など）
- 会話履歴の確認

**ゲスト側の動作**:
- QRコードを読み取る
- 言語を選択
- チャット形式で質問
- AIが自動回答（FAQに基づく、またはAI生成）`
      },
      {
        id: 'intro-howto',
        title: '1.2 本マニュアルの使い方',
        content: `**目次の使い方**:
- 左側の目次から章・項目をクリックすると、該当箇所にスクロールします
- 現在表示中の章は青くハイライトされます
- 章タイトルをクリックすると、その章の項目が折りたたみ/展開されます

**モバイルでの使い方**:
- 画面右上のメニューアイコン（☰）をタップすると、目次が表示されます
- 目次から項目をタップすると、該当箇所にスクロールします

**強調表示について**:
- 💡 **ポイント**: 重要な情報やヒント
- ⚠️ **注意**: 注意が必要な事項
- ✅ **ベストプラクティス**: 推奨される使い方`
      },
      {
        id: 'intro-requirements',
        title: '1.3 システム要件',
        content: `**推奨ブラウザ**:
- Chrome（最新版）
- Safari（最新版）
- Firefox（最新版）
- Edge（最新版）

**動作環境**:
- インターネット接続が必要です
- スマートフォン・タブレット・デスクトップで利用可能です
- ゲスト側はPWA対応のため、スマートフォンにホーム画面追加が可能です

**必要な情報**:
- ログイン用のメールアドレスとパスワード
- 施設の基本情報（チェックイン/アウト時間、WiFi情報など）`
      },
      {
        id: 'intro-initial-setup',
        title: '1.4 初期設定',
        content: `**初期設定の流れ**:
YadOPERAを利用開始する前に、以下の手順で初期設定を行ってください。

1. **施設設定の確認**（第6章参照）
   - 施設名、メールアドレス、電話番号、住所が正しく入力されているか確認
   - WiFi SSID、WiFiパスワードが正しく入力されているか確認
   - チェックイン/アウト時間が正しく設定されているか確認
   - 館内ルール、周辺情報が入力されているか確認
   - スタッフ不在時間帯が正しく設定されているか確認

2. **FAQの登録**（第4章参照）
   - 20件の初期デフォルトFAQを確認して編集や削除や追加してください
   - 基本情報のFAQ（チェックイン/アウト時間、WiFi情報など）を確認・編集
   - 設備・サービスのFAQ（キッチン、シャワー、洗濯機など）を確認・編集
   - 場所・アクセスのFAQ（最寄り駅、コンビニ、レストランなど）を確認・編集
   - トラブル対応のFAQ（鍵紛失、WiFi不通、設備故障など）を確認・編集
   - 各FAQの優先度を適切に設定（よく聞かれる質問ほど高く設定）

3. **QRコードの発行**（第7章参照）
   - 各設置場所（入口、客室、キッチン、ラウンジなど）のQRコードを生成
   - QRコードを印刷して、適切な場所に設置
   - QRコードが正しく読み取れるかテスト

4. **動作確認**
   - ゲスト側の画面が正しく表示されるか確認
   - AI回答が正しく生成されるか確認
   - エスカレーションが正しく動作するか確認

5. **初期設定チェックリストを確認**（第11章参照）
   - 第11章「運用のベストプラクティス」の「11.1 初期設定チェックリスト」を参照して、すべての項目が完了しているか確認してください

**初期設定のポイント**:
- 初期設定は一度だけ行えば、その後は必要に応じて更新するだけです
- FAQは、ゲストがよく聞く質問から優先的に登録してください
- QRコードは、ゲストがアクセスしやすい場所に設置してください`
      }
    ]
  },
  {
    id: 'login',
    title: '第2章 ログイン・ログアウト',
    subsections: [
      {
        id: 'login-first',
        title: '2.1 初回ログイン',
        content: `**ログイン画面へのアクセス**:
- ブラウザで管理画面のURLにアクセスすると、ログイン画面が表示されます
- ログイン画面では、メールアドレスとパスワードを入力します

**ログイン手順**:
1. メールアドレスを入力（例: \`admin@example.com\`）
2. パスワードを入力（8文字以上）
3. 「ログイン / Login」ボタンをクリック

**ログイン成功後**:
- ダッシュボード画面が表示されます
- ログイン状態はブラウザに保存されるため、次回アクセス時も自動的にログイン状態が維持されます

**新規登録について**:
- 初めてYadOPERAを利用する場合は、新規登録画面（\`/register\`）で施設情報を登録します
- 施設名、メールアドレス、パスワード、料金プランを入力して登録します
- 登録完了後、自動的にログイン状態になります`
      },
      {
        id: 'login-logout',
        title: '2.2 ログアウト',
        content: `**ログアウト手順**:
1. 画面右上のユーザーアイコンをクリック
2. 表示されるメニューから「ログアウト / Logout」をクリック
3. ログイン画面にリダイレクトされます

**ログアウト後の動作**:
- ログイン状態が解除され、ログイン画面が表示されます
- 再度ログインするには、メールアドレスとパスワードを入力する必要があります`
      },
      {
        id: 'login-error',
        title: '2.3 ログインできない場合',
        content: `**よくある原因と対処法**:

**1. メールアドレスまたはパスワードが間違っている**:
- メールアドレスに誤字・脱字がないか確認してください
- パスワードの大文字・小文字を確認してください
- パスワードは8文字以上必要です

**2. エラーメッセージが表示される**:
- 「Incorrect email or password」と表示される場合、メールアドレスまたはパスワードが正しくありません
- 「ログインに失敗しました。メールアドレスとパスワードを確認してください。」と表示される場合も同様です

**3. ブラウザキャッシュの問題**:
- ブラウザのキャッシュをクリアしてから再度ログインを試してください
- 詳細な手順は「第10章 トラブルシューティング」の「10.3 ブラウザキャッシュのクリア方法」を参照してください

**4. それでもログインできない場合**:
- システム管理者にお問い合わせください
- 問い合わせ方法は「第10章 トラブルシューティング」の「10.4 問い合わせ方法」を参照してください`
      }
    ]
  },
  {
    id: 'dashboard',
    title: '第3章 ダッシュボードの見方',
    subsections: [
      {
        id: 'dashboard-overview',
        title: '3.1 ダッシュボード概要',
        content: `**ダッシュボードとは**:
- ダッシュボードは、YadOPERAの利用状況を一目で確認できる画面です
- ログイン後、最初に表示されます
- 月次統計、週次サマリー、リアルタイム情報を表示します

**ダッシュボードの構成**:
- **月次統計セクション**: 現在の請求期間の利用状況とコスト情報（最優先表示エリア）
- **週次サマリー統計**: 過去7日間の統計情報
- **カテゴリ別内訳**: 質問のカテゴリ別集計
- **リアルタイムチャット履歴**: 最新10件の会話
- **スタッフ不在時間帯対応キュー**: エスカレーション待ちの質問
- **ゲストフィードバック集計**: ゲストからの評価統計

**データの更新タイミング**:
- ダッシュボードのデータは自動的に更新されます
- 他のページから戻った際も、最新データが表示されます

**請求期間について**:
- 月次統計は、契約開始日から1ヶ月間の請求期間で集計されます
- 請求期間は、プラン契約日から次の同じ日付の前日までです（例: 1月15日に契約した場合、1月15日〜2月14日が1請求期間）
- 週次サマリー統計は、過去7日間のデータを表示します`
      },
      {
        id: 'dashboard-total',
        title: '3.2 総質問数',
        content: `**表示内容**:
- 過去7日間にゲストから寄せられた質問の総数が表示されます

**見方**:
- 数値が大きいほど、ゲストの利用が活発です
- 週次サマリー統計カードの「総質問数」で確認できます

**活用方法**:
- 繁忙期・閑散期の把握
- プロモーション効果の測定
- 施設の稼働率との相関分析

**月次統計との違い**:
- 週次サマリーの「総質問数」は過去7日間のデータです
- 月次統計の「現在の請求期間の質問数」は、契約開始日から1ヶ月間の請求期間での累計データです`
      },
      {
        id: 'dashboard-rate',
        title: '3.3 自動応答率',
        content: `**表示内容**:
- 過去7日間にAIが自動で回答した質問の割合が表示されます
- 週次サマリー統計カードの「自動応答率」で確認できます

**見方**:
- パーセンテージで表示されます（例: 85.5%）
- 数値が高いほど、AIが自動で対応できていることを示します

**計算方法**:
- 自動応答率 = (総質問数 - エスカレーション数) ÷ 総質問数 × 100

**月次統計との違い**:
- 週次サマリーの「自動応答率」は過去7日間のデータです
- 月次統計の「AI自動応答数」は、現在の請求期間での累計データと自動化率を表示します`
      },
      {
        id: 'dashboard-confidence',
        title: '3.4 平均信頼度',
        content: `**表示内容**:
- 過去7日間のAI回答の信頼度の平均値が表示されます
- 週次サマリー統計カードの「平均信頼度」で確認できます

**見方**:
- パーセンテージで表示されます（例: 92.3%）
- 数値が高いほど、AI回答の信頼度が高いことを示します

**信頼度とは**:
- AIが回答を生成する際の自信度を数値化したものです
- 信頼度が低い回答は、エスカレーション（スタッフ対応）に回される場合があります`
      },
      {
        id: 'dashboard-unresolved',
        title: '3.5 未解決質問',
        content: `**表示内容**:
- エスカレーション待ちの質問数が表示されます
- 週次サマリー統計カードの「未解決質問」で確認できます

**見方**:
- 数値が大きいほど、対応が必要な質問が多いことを示します
- 数値が0の場合は、すべての質問に対応済みです

**月次統計との違い**:
- 週次サマリーの「未解決質問」は過去7日間のデータです
- 月次統計の「未解決のエスカレーション」は、現在の請求期間での未解決質問のリストを表示します

**対応方法**:
- 未解決の質問は「スタッフ不在時間帯対応キュー」で確認・対応できます
- 詳細は「第5章 スタッフ不在時間帯対応キュー」を参照してください`
      },
      {
        id: 'dashboard-category',
        title: '3.6 カテゴリ別内訳',
        content: `**表示内容**:
- 過去7日間のメッセージで使用されたFAQのカテゴリ別集計が表示されます
- カテゴリ別内訳セクションで確認できます

**カテゴリの種類**:
- **Basic**: 基本的な質問（チェックイン/アウト時間、WiFi情報など）
- **Facilities**: 設備に関する質問（シャワー、キッチン、洗濯機など）
- **Location**: 周辺情報に関する質問（コンビニ、駅、レストランなど）
- **Trouble**: トラブルに関する質問（鍵紛失、設備故障など）

**見方**:
- 各カテゴリの件数が表示されます
- 合計件数も表示されます

**活用方法**:
- どのカテゴリの質問が多いかを把握できます
- FAQ管理画面で、不足しているカテゴリのFAQを追加する参考にできます`
      },
      {
        id: 'dashboard-realtime',
        title: '3.7 リアルタイムチャット履歴',
        content: `**表示内容**:
- 最新10件の会話が表示されます
- リアルタイムチャット履歴セクションで確認できます

**表示項目**:
- **言語**: ゲストが選択した言語（英語、日本語、繁体中国語など）
- **最終メッセージ**: 会話の最後のメッセージ
- **信頼度**: AI回答の信頼度
- **作成日時**: 会話が開始された日時（相対時刻で表示、例: 「5分前」）

**会話詳細の確認**:
- 会話をクリックすると、会話詳細画面に遷移します
- 会話の全履歴、ゲスト情報、AI回答の信頼度などを確認できます

**活用方法**:
- 最新の会話を素早く確認できます
- 問題のある会話を早期に発見できます
- 詳細は「第8章 会話詳細の確認」を参照してください`
      }
    ]
  },
  {
    id: 'faq',
    title: '第4章 FAQ管理',
    subsections: [
      {
        id: 'faq-overview',
        title: '4.1 FAQ管理画面の概要',
        content: `**FAQ管理画面とは**:
- FAQ管理画面では、ゲストからの質問に対する回答を登録・管理できます
- 登録したFAQは、AIが自動的に参照してゲストの質問に回答します
- 左メニューから「FAQ管理」をクリックしてアクセスします

**FAQ管理画面の構成**:
- **FAQ一覧**: 登録済みのFAQをカテゴリ別に表示
- **新規FAQ登録ボタン**: 新しいFAQを追加
- **FAQ改善提案**: 未解決質問や低評価回答からFAQ改善提案を生成
- **未解決質問リスト**: エスカレーション待ちの質問を表示

**FAQの基本構造**:
- **カテゴリ**: Basic（基本情報）、Facilities（施設情報）、Location（場所・アクセス）、Trouble（トラブル対応）
- **インテントベース構造**: 同じ意図の質問を1つのFAQとして管理し、複数言語の翻訳を登録できます
- **優先度**: 1（低）〜 5（高）で設定可能
- **有効/無効**: 一時的にFAQを無効化できます`
      },
      {
        id: 'faq-list',
        title: '4.2 FAQ一覧の見方',
        content: `**FAQ一覧の表示**:
- FAQ一覧では、登録済みのFAQがカテゴリ別に表示されます
- カテゴリフィルタで特定のカテゴリのみを表示できます
- 各FAQには、質問文、回答文、カテゴリ、優先度が表示されます

**FAQの表示項目**:
- **質問文**: ゲストが入力する可能性のある質問
- **回答文**: AIがゲストに返す回答
- **カテゴリ**: FAQの分類（Basic、Facilities、Location、Trouble）
- **優先度**: 1（低）〜 5（高）
- **言語**: 登録されている言語の翻訳数が表示されます

**FAQの操作**:
- **編集**: 各FAQの編集ボタンから内容を変更できます
- **削除**: 不要なFAQを削除できます（確認ダイアログが表示されます）
- **有効/無効切替**: 一時的にFAQを無効化できます`
      },
      {
        id: 'faq-create',
        title: '4.3 新規FAQ登録',
        content: `**新規FAQ登録の手順**:
1. FAQ管理画面で「新規FAQ登録」ボタンをクリック
2. モーダルフォームが表示されます
3. 以下の項目を入力:
   - **カテゴリ**: Basic、Facilities、Location、Troubleから選択
   - **優先度**: 1（低）〜 5（高）から選択
   - **質問文**: ゲストが入力する可能性のある質問（各言語ごと）
   - **回答文**: AIがゲストに返す回答（各言語ごと）
4. 「登録」ボタンをクリックして保存

**複数言語対応**:
- 主要な言語（英語、日本語など）は必ず登録することを推奨します
- ゲストの利用言語に応じて、必要な言語を追加する（プランによって言語数に制限があります）
- 同じFAQに対して、複数言語の翻訳を登録できます
- 各言語の質問文と回答文を個別に入力します

**FAQ登録時の注意点**:
- 質問文は、ゲストが実際に入力する可能性のある表現で記載してください
- 回答文は、簡潔で分かりやすい内容にしてください（200文字以内を推奨）
- カテゴリは、FAQの内容に適したものを選択してください
- 優先度は、よく聞かれる質問ほど高く設定してください`
      },
      {
        id: 'faq-edit',
        title: '4.4 FAQ編集',
        content: `**FAQ編集の手順**:
1. FAQ一覧で、編集したいFAQの「編集」ボタンをクリック
2. モーダルフォームが表示されます
3. 質問文、回答文、カテゴリ、優先度を変更できます
4. 各言語の翻訳を個別に編集できます
5. 「保存」ボタンをクリックして変更を保存

**FAQ編集時の注意点**:
- 既存の翻訳を編集する場合は、その言語の質問文と回答文を更新できます
- 新しい言語の翻訳を追加する場合は、「言語を追加」ボタンから追加できます（プランによって言語数に制限があります）
- 既存の翻訳を削除する場合は、その言語の翻訳を削除できます
- 変更内容は即座に反映され、次回のAI回答から使用されます`
      },
      {
        id: 'faq-delete',
        title: '4.5 FAQ削除',
        content: `**FAQ削除の手順**:
1. FAQ一覧で、削除したいFAQの「削除」ボタンをクリック
2. 確認ダイアログが表示されます
3. 「削除」をクリックして確定

**FAQ削除時の注意点**:
- 削除したFAQは復元できません
- 削除後、そのFAQはAI回答から参照されなくなります
- 削除前に、そのFAQが本当に不要かどうか確認してください
- 一時的に無効化したい場合は、削除ではなく「有効/無効切替」を使用してください`
      },
      {
        id: 'faq-suggestion',
        title: '4.6 FAQ改善提案機能',
        content: `**FAQ改善提案機能とは**:
- 未解決質問や低評価回答から、新しいFAQの提案を自動生成します
- ゲストからのフィードバックを活用して、FAQを改善できます

**FAQ改善提案の生成方法**:
1. **未解決質問から生成**:
   - 未解決質問リストから、FAQ改善提案を生成したい質問を選択
   - 「FAQ改善提案を生成」ボタンをクリック
   - AIが質問文と回答文のテンプレートを生成します

2. **低評価回答から生成**:
   - ゲストフィードバックで低評価がついた回答から、FAQ改善提案を生成
   - 低評価回答が2回以上ついた場合は自動ハイライトされます
   - 「FAQ改善提案を生成」ボタンをクリック

**FAQ改善提案の承認・却下**:
- 生成された提案を確認し、必要に応じて修正します
- 「承認」をクリックすると、新しいFAQとして登録されます
- 「却下」をクリックすると、提案が削除されます
- 承認後、そのFAQはAI回答から参照されるようになります`
      },
      {
        id: 'faq-best-practices',
        title: '4.7 FAQ作成のベストプラクティス',
        content: `**効果的なFAQ作成のポイント**:

**1. 質問文の書き方**:
- ゲストが実際に入力する可能性のある表現で記載してください
- 複数の言い回しを想定して、複数の質問パターンを登録することもできます
- 例: 「WiFiパスワードは？」「WiFiのパスワードを教えて」「インターネットのパスワードは？」

**2. 回答文の書き方**:
- 簡潔で分かりやすい内容にしてください（200文字以内を推奨）
- 具体的な情報を含めてください（例: 「WiFiパスワードは12345678です」）
- 必要に応じて、追加情報への案内を含めてください（例: 「詳細はフロントでお尋ねください」）

**3. カテゴリの選択**:
- FAQの内容に適したカテゴリを選択してください
- Basic: チェックイン/アウト時間、WiFi情報など
- Facilities: 施設内の設備、サービスなど
- Location: 最寄り駅、周辺情報など
- Trouble: トラブル対応、緊急連絡先など

**4. 優先度の設定**:
- よく聞かれる質問ほど高く設定してください
- 優先度が高いFAQほど、AI回答で優先的に参照されます

**5. 多言語対応**:
- 主要な言語（英語、日本語など）は必ず登録してください
- ゲストの利用言語に応じて、必要な言語を追加してください（プランによって言語数に制限があります）
- 各言語の質問文と回答文は、その言語で自然な表現になるように記載してください

**6. FAQの継続的な改善**:
- 未解決質問や低評価回答から、FAQ改善提案を生成して活用してください
- 定期的にFAQを見直し、不要なFAQを削除したり、内容を更新したりしてください
- ゲストからのフィードバックを参考に、FAQを改善してください`
      }
    ]
  },
  {
    id: 'overnight-queue',
    title: '第5章 スタッフ不在時間帯対応キュー',
    subsections: [
      {
        id: 'overnight-overview',
        title: '5.1 スタッフ不在時間帯対応キューとは',
        content: `**スタッフ不在時間帯対応キューとは**:
- スタッフ不在時間帯にエスカレーションされた質問を管理する機能です
- スタッフ不在時間帯にゲストからの質問がエスカレーションされた場合、その質問はキューに追加されます
- スタッフ不在時間帯の終了時刻にスタッフへ通知されます

**キューに追加される条件**:
- スタッフ不在時間帯にエスカレーションされた質問
- スタッフ不在時間帯が設定されている場合のみ、キューに追加されます
- スタッフ不在時間帯が設定されていない場合は、エスカレーションは直接スタッフへ通知されます

**キューの表示場所**:
- ダッシュボードの「スタッフ不在時間帯対応キュー」セクション
- 左メニューから「スタッフ不在時間帯対応キュー」をクリックして専用ページにアクセスできます

**スタッフ不在時間帯設定について**:
- スタッフ不在時間帯は、施設設定画面（第6章参照）で設定できます
- 開始時刻、終了時刻、曜日を指定できます
- 複数の時間帯を設定できます（例: 平日の22:00-8:00、週末の23:00-9:00）`
      },
      {
        id: 'overnight-list',
        title: '5.2 対応キュー一覧の見方',
        content: `**統計情報の表示**:
- **未対応**: まだ対応していない質問の件数
- **対応済み**: 対応済みとしてマークされた質問の件数
- **合計**: すべての質問の件数

**キューリストの表示項目**:
- **ゲストメッセージ**: ゲストが入力した質問内容
- **言語**: ゲストが選択した言語（英語、日本語、繁体中国語など）
- **対応予定時刻**: スタッフ不在時間帯の終了時刻（通知予定時刻）
- **作成日時**: キューに追加された日時
- **対応状況**: 対応済みかどうか（対応済みの場合は「対応済み」バッジが表示されます）

**キューの状態**:
- **未対応**: まだ対応していない質問（通常表示）
- **対応済み**: 対応済みとしてマークされた質問（グレーアウト表示）

**説明文について**:
- 画面の上部に説明文が表示されます
- スタッフ不在時間帯が設定されている場合は、設定された時間帯が表示されます
- スタッフ不在時間帯が設定されていない場合は、エスカレーションは直接スタッフへ通知される旨が表示されます`
      },
      {
        id: 'overnight-response',
        title: '5.3 質問への対応',
        content: `**対応済みにする手順**:
1. スタッフ不在時間帯対応キュー画面で、対応したい質問を確認します
2. 「対応済み」ボタンをクリックします
3. 質問が対応済みとしてマークされ、キューリストからグレーアウト表示されます

**対応時の注意点**:
- 対応済みにすると、キューリストから削除されるわけではありません（表示は残りますが、グレーアウト表示になります）
- 対応済みにした後も、会話詳細画面から質問内容を確認できます
- 対応済みにした質問は、統計情報の「対応済み」にカウントされます

**手動実行機能**:
- 「手動実行」ボタンをクリックすると、通知予定時刻が来ている質問をスタッフへ通知できます
- 処理された件数が表示されます
- スタッフ不在時間帯が設定されていない場合は、この機能は使用できません

**通知のタイミング**:
- スタッフ不在時間帯の終了時刻に自動的に通知されます
- 手動実行ボタンで、通知予定時刻が来ている質問を即座に通知することもできます
- 通知後、ゲストには自動返信メッセージが送信されます（英語/日本語対応）`
      },
      {
        id: 'overnight-manage',
        title: '5.4 対応済み質問の管理',
        content: `**対応済み質問の確認**:
- 対応済みの質問は、キューリストでグレーアウト表示されます
- 「対応済み」バッジが表示されます
- 対応済みの質問も、会話詳細画面から質問内容を確認できます

**対応済み質問の統計**:
- 対応済みの質問は、統計情報の「対応済み」にカウントされます
- 対応済みの質問は、デフォルトではキューリストに表示されません（未対応の質問のみ表示されます）

**対応済み質問の活用**:
- 対応済みの質問を確認することで、過去の対応履歴を把握できます
- よくある質問や対応パターンを把握する参考にできます
- 対応済みの質問から、FAQ改善提案を生成することもできます

**対応済み質問の表示**:
- 対応済みの質問を表示するには、専用ページで「解決済みを含める」オプションを有効にします
- 対応済みの質問は、グレーアウト表示され、「対応済み」バッジが表示されます`
      }
    ]
  },
  {
    id: 'facility',
    title: '第6章 施設設定',
    subsections: [
      {
        id: 'facility-overview',
        title: '6.1 施設設定画面の概要',
        content: `**施設設定画面とは**:
- 施設情報の編集と各種設定を行う画面です
- 左メニューから「施設設定」をクリックしてアクセスします
- 基本情報、WiFi設定、チェックイン/アウト時間、館内ルール・周辺情報、スタッフ不在時間帯設定、パスワード変更などができます

**施設設定画面の構成**:
- **基本情報セクション**: 施設名、メールアドレス、電話番号、住所
- **WiFi設定セクション**: WiFi SSID、WiFiパスワード
- **チェックイン/アウト時間セクション**: チェックイン時間、チェックアウト時間
- **館内ルール・周辺情報セクション**: 館内ルール、周辺情報
- **スタッフ不在時間帯セクション**: スタッフ不在時間帯の設定
- **パスワード変更セクション**: ログインパスワードの変更
- **表示のみのセクション**: 対応言語、タイムゾーン

**設定の保存**:
- 画面下部の「保存」ボタンをクリックして設定を保存します
- 保存後、設定内容が即座に反映されます
- 「キャンセル」ボタンをクリックすると、変更を破棄してダッシュボードに戻ります`
      },
      {
        id: 'facility-basic',
        title: '6.2 基本情報設定',
        content: `**基本情報の設定項目**:
- **施設名**: 必須項目、1-255文字以内
- **メールアドレス**: 必須項目、メール形式
- **電話番号**: 任意項目、最大50文字
- **住所**: 任意項目

**設定方法**:
1. 各項目の入力欄に情報を入力します
2. 必須項目（施設名、メールアドレス）は必ず入力してください
3. 任意項目は必要に応じて入力してください
4. 設定を保存するには、画面下部の「保存」ボタンをクリックします

**WiFi設定**:
- **WiFi SSID**: WiFiネットワーク名（任意項目、最大100文字）
- **WiFiパスワード**: 変更する場合のみ入力（現在のパスワードは表示されません）
- WiFiパスワードを変更しない場合は、入力欄を空欄のままにします

**チェックイン/アウト時間**:
- **チェックイン時間**: チェックイン可能な時間（時刻形式、例: 15:00）
- **チェックアウト時間**: チェックアウト可能な時間（時刻形式、例: 11:00）

**館内ルール・周辺情報**:
- **館内ルール**: 館内のルールや注意事項（任意項目、最大1000文字、AI応答のコンテキストに使用されます）
- **周辺情報**: 最寄り駅、コンビニ、レストランなどの周辺情報（任意項目、最大1000文字、AI応答のコンテキストに使用されます）

**注意点**:
- 施設名とメールアドレスは必須項目のため、空欄にすることはできません
- メールアドレスは正しいメール形式で入力してください
- 電話番号と住所は任意項目ですが、ゲストからの問い合わせ対応に役立ちます
- 館内ルール・周辺情報は、AIがゲストの質問に回答する際のコンテキストとして使用されます`
      },
      {
        id: 'facility-overnight',
        title: '6.3 スタッフ不在時間帯設定',
        content: `**スタッフ不在時間帯設定とは**:
- スタッフが不在の時間帯を設定する機能です
- この時間帯にエスカレーションが発生した場合、スタッフ不在時間帯対応キューに追加されます
- スタッフ不在時間帯の終了時刻にスタッフへ通知されます

**設定方法**:
1. 「スタッフ不在時間帯」セクションで、各時間帯を設定します
2. 各時間帯には以下の項目を設定します:
   - **開始時刻**: スタッフ不在時間帯の開始時刻（HH:MM形式、例: 22:00）
   - **終了時刻**: スタッフ不在時間帯の終了時刻（HH:MM形式、例: 08:00）
   - **曜日**: 適用する曜日を選択（複数選択可能、月、火、水、木、金、土、日）
3. 複数の時間帯を設定する場合は、「+ 時間帯を追加」ボタンをクリックします
4. 不要な時間帯を削除する場合は、各時間帯の「削除」ボタンをクリックします

**設定例**:
- **平日の夜間**: 22:00-8:00（月、火、水、木、金）
- **週末の夜間**: 23:00-9:00（土、日）
- **全曜日**: 22:00-8:00（月、火、水、木、金、土、日）

**注意点**:
- 日を跨ぐ時間帯（例: 22:00-8:00）も設定できます
- スタッフ不在時間帯が設定されていない場合は、エスカレーションは直接スタッフへ通知されます
- スタッフ不在時間帯の終了時刻が通知予定時刻になります
- 詳細は「第5章 スタッフ不在時間帯対応キュー」を参照してください`
      },
      {
        id: 'facility-save',
        title: '6.4 施設情報の保存',
        content: `**保存の手順**:
1. 各セクションで設定を変更します
2. 画面下部の「保存」ボタンをクリックします
3. 保存が完了すると、成功メッセージが表示されます
4. 設定内容が即座に反映されます

**保存時のバリデーション**:
- **施設名**: 必須項目、1-255文字以内
- **メールアドレス**: 必須項目、メール形式
- **WiFiパスワード**: 変更する場合のみ入力（空欄の場合は変更されません）
- **チェックイン/アウト時間**: 時刻形式（HH:MM）
- **館内ルール・周辺情報**: 最大1000文字以内
- **スタッフ不在時間帯**: 開始時刻、終了時刻、曜日が必須

**保存時の注意点**:
- 必須項目が未入力の場合、エラーメッセージが表示されます
- バリデーションエラーがある場合は、該当項目を修正してから再度保存してください
- 保存後、設定内容は即座に反映されます（次回のAI回答から使用されます）

**キャンセル**:
- 「キャンセル」ボタンをクリックすると、変更を破棄してダッシュボードに戻ります
- 保存していない変更は失われます

**パスワード変更**:
- パスワード変更は、施設設定とは別のセクションで行います
- 現在のパスワード、新しいパスワード（8文字以上）、確認パスワードを入力します
- 「パスワードを変更」ボタンをクリックして変更します
- パスワード変更は、施設設定の保存とは独立して実行されます`
      }
    ]
  },
  {
    id: 'qr-code',
    title: '第7章 QRコード発行',
    subsections: [
      {
        id: 'qr-overview',
        title: '7.1 QRコードとは',
        content: `**QRコードとは**:
- ゲストがスマートフォンで読み取って、YadOPERAのチャット画面にアクセスするためのコードです
- QRコードを読み取ると、ゲストは言語選択画面にアクセスできます
- 設置場所別にQRコードを生成でき、ゲストがどの場所でQRコードを読み取ったかを記録できます

**QRコードの用途**:
- 施設内の各場所（入口、客室、キッチン、ラウンジなど）に設置
- ゲストがスマートフォンのカメラで読み取るだけで、アプリのインストール不要でアクセス可能
- 設置場所情報は、ゲストの行動分析や統計に活用できます

**QRコードの表示場所**:
- 左メニューから「QRコード発行」をクリックしてアクセスします
- QRコード発行画面で、設置場所を選択してQRコードを生成できます`
      },
      {
        id: 'qr-generate',
        title: '7.2 QRコード発行手順',
        content: `**QRコード発行の手順**:
1. QRコード発行画面で、設置場所を選択します
   - **入口**: 施設の入口に設置
   - **客室**: 各客室に設置
   - **キッチン**: キッチンに設置
   - **ラウンジ**: ラウンジに設置
   - **カスタム**: その他の場所に設置（カスタム設置場所名を入力）
2. カスタム設置場所を選択した場合は、カスタム設置場所名を入力します（50文字以内）
3. 設置場所を選択すると、QRコードのプレビューが自動的に表示されます
4. プレビュー下のボタンから、PDF/PNG/SVG形式でダウンロードできます
5. 「生成済みQRコード一覧に追加」ボタンをクリックすると、生成済みQRコード一覧に保存されます

**プレビュー機能**:
- 設置場所を選択すると、QRコードのプレビューが自動的に生成されます
- プレビューには、QRコード画像と、QRコードに埋め込まれたURLが表示されます
- プレビューから直接ダウンロードすることもできます

**生成済みQRコード一覧**:
- 「生成済みQRコード一覧に追加」ボタンをクリックすると、生成済みQRコード一覧に追加されます
- 生成済みQRコード一覧では、各QRコードをPDF/PNG/SVG形式でダウンロードできます
- 不要なQRコードは「一覧から削除」ボタンで削除できます`
      },
      {
        id: 'qr-download',
        title: '7.3 QRコードのダウンロード',
        content: `**ダウンロード形式**:
- **PDF**: A4印刷用サイズ、そのまま印刷して使用する場合に適しています
- **PNG**: 画像形式、デジタル表示や印刷に適しています（加工編集用）
- **SVG**: ベクター形式、拡大縮小しても画質が劣化しません（加工編集用）

**ダウンロード方法**:
1. **プレビューからダウンロード**:
   - プレビュー下の「PDF ダウンロード」「PNG ダウンロード」「SVG ダウンロード」ボタンをクリックします
   - 選択した形式でQRコードがダウンロードされます

2. **生成済みQRコード一覧からダウンロード**:
   - 生成済みQRコード一覧で、各QRコードの「PDF」「PNG」「SVG」ボタンをクリックします
   - 既に同じ形式で生成されている場合は、既存のファイルがダウンロードされます
   - 異なる形式の場合は、自動的に再生成されてダウンロードされます

**ダウンロード時の注意点**:
- ダウンロードしたQRコードファイルは、適切な場所に保存してください
- ファイル名は、設置場所とIDを含む形式です（例: \`qrcode-entrance-1.png\`）
- 同じ設置場所で複数のQRコードを生成した場合、IDで区別されます`
      },
      {
        id: 'qr-install',
        title: '7.4 QRコードの設置方法',
        content: `**設置場所の選定**:
- ゲストがアクセスしやすい場所に設置してください
- 入口、客室、キッチン、ラウンジなど、ゲストが質問をしやすい場所に設置することを推奨します
- 複数の場所に設置することで、ゲストの利便性が向上します

**設置時の注意点**:
- **サイズ**: 推奨サイズは10cm × 10cm以上（A4印刷用サイズ）です
- **印刷品質**: 印刷時は、QRコードがはっきりと見えるように印刷してください
- **設置位置**: ゲストがスマートフォンで読み取りやすい高さに設置してください
- **照明**: 暗い場所に設置する場合は、照明を確保してください

**設置例**:
- **入口**: 受付カウンターや入口付近の壁面
- **客室**: 各客室のドアや壁面
- **キッチン**: キッチンの壁面や冷蔵庫のドア
- **ラウンジ**: ラウンジのテーブルや壁面

**カスタム設置場所**:
- カスタム設置場所を選択した場合は、設置場所名を入力してください（例: 「受付カウンター」「2階エレベーター前」など）
- カスタム設置場所名は、生成済みQRコード一覧に表示されます`
      },
      {
        id: 'qr-test',
        title: '7.5 QRコードのテスト',
        content: `**テストの重要性**:
- QRコードを設置する前に、必ずテストしてください
- テストにより、QRコードが正しく読み取れるか、正しい画面にアクセスできるかを確認できます

**テスト手順**:
1. 生成したQRコードを印刷するか、スマートフォンの画面に表示します
2. 別のスマートフォンでQRコードを読み取ります
3. 言語選択画面が表示されることを確認します
4. 言語を選択して、ウェルカム画面が表示されることを確認します
5. チャット画面で質問を送信して、AIが回答することを確認します

**テスト時の注意点**:
- 実際のスマートフォンでテストしてください（PCの画面では読み取れない場合があります）
- 複数のスマートフォンでテストして、互換性を確認してください
- 異なる照明条件でテストして、読み取りやすさを確認してください
- 設置予定の場所で実際にテストして、読み取りやすさを確認してください

**問題が発生した場合**:
- QRコードが読み取れない場合は、印刷品質やサイズを確認してください
- 正しい画面にアクセスできない場合は、QRコードを再生成してください
- 設置場所情報が正しく記録されない場合は、QRコードのURLを確認してください`
      }
    ]
  },
  {
    id: 'conversation',
    title: '第8章 会話詳細の確認',
    subsections: [
      {
        id: 'conversation-overview',
        title: '8.1 会話詳細画面の概要',
        content: `**会話詳細画面とは**:
- ゲストとAIの会話履歴を詳細に確認できる画面です
- ダッシュボードの「リアルタイムチャット履歴」や「未解決のエスカレーション」から会話をクリックしてアクセスします
- 会話の内容、AIの信頼度、使用したFAQなどを確認できます

**会話詳細画面の構成**:
- **会話情報カード**: セッションID、言語、設置場所、開始時刻、最終活動時刻、メッセージ数
- **メッセージ一覧**: ゲストとAIのメッセージを時系列順に表示
- **AI回答の詳細**: 信頼度、使用したFAQカテゴリを表示

**会話詳細画面へのアクセス方法**:
1. **ダッシュボードから**: 「リアルタイムチャット履歴」セクションで会話をクリック
2. **未解決エスカレーションから**: 「未解決のエスカレーション」セクションで会話をクリック
3. 会話詳細画面が表示され、会話の全履歴を確認できます

**戻る方法**:
- 画面左上の「← ダッシュボードに戻る」ボタンをクリックすると、ダッシュボードに戻ります`
      },
      {
        id: 'conversation-history',
        title: '8.2 会話履歴の見方',
        content: `**メッセージ一覧の表示**:
- メッセージは時系列順（古い順）に表示されます
- 各メッセージには、ロール（ゲスト、AI、システム）が表示されます
- メッセージの送信時刻が表示されます

**メッセージの種類**:
- **ゲスト**: ゲストが入力した質問やメッセージ（青色のバッジ）
- **AI**: AIが生成した回答（緑色のバッジ）
- **システム**: システムからの自動メッセージ（グレーのバッジ）

**AI回答の詳細情報**:
- **信頼度**: AI回答の信頼度が表示されます（0%〜100%）
- **使用したFAQ**: AI回答に使用されたFAQのカテゴリが表示されます
  - 基本情報（青色）
  - 設備・サービス（緑色）
  - 場所・アクセス（黄色）
  - トラブル対応（赤色）

**メッセージの表示内容**:
- メッセージの内容は、改行が保持された状態で表示されます
- 長いメッセージは、全文が表示されます

**FAQカテゴリの表示**:
- AI回答に使用されたFAQがある場合、「使用したFAQ:」の下にカテゴリが表示されます
- 複数のFAQが使用された場合、複数のカテゴリが表示されます`
      },
      {
        id: 'conversation-guest',
        title: '8.3 ゲスト情報の確認',
        content: `**会話情報カードの表示項目**:
- **セッションID**: 会話を識別するための一意のID
- **言語**: ゲストが選択した言語（英語、日本語、繁体中国語など）
- **設置場所**: QRコードを読み取った場所（入口、客室、キッチン、ラウンジなど）
- **開始時刻**: 会話が開始された時刻
- **最終活動時刻**: 最後にメッセージが送信された時刻
- **メッセージ数**: 会話内のメッセージ総数

**ゲスト情報の活用**:
- セッションIDで会話を識別できます
- 言語情報から、ゲストの利用言語を把握できます
- 設置場所情報から、ゲストがどの場所でQRコードを読み取ったかを把握できます
- 開始時刻と最終活動時刻から、会話の継続時間を把握できます
- メッセージ数から、会話の長さを把握できます

**会話情報の確認方法**:
- 会話詳細画面の上部に「会話情報」カードが表示されます
- 各項目は、グリッド形式で表示されます

**重要な注意点**:
- **部屋番号やゲスト名などの個人情報は保存されていません**
- ゲストはQRコードを読み取るだけでアクセスするため、ログインや登録は不要です
- 匿名性を重視した設計のため、個人情報を収集・保存する仕組みはありません
- エスカレーション対応時は、会話内容、設置場所、時刻などの情報を活用して対応してください`
      },
      {
        id: 'conversation-reply',
        title: '8.4 エスカレーション対応について',
        content: `**手動返信機能について**:
- 現在、システム内でゲストに直接返信する手動返信機能は実装されていません
- 将来のバージョンで実装予定です

**エスカレーション対応の実務的な流れ**:
1. **質問の確認**:
   - ダッシュボードの「未解決のエスカレーション」または「スタッフ不在時間帯対応キュー」で質問を確認します
   - 会話詳細画面で質問内容、設置場所、時刻を確認します

2. **対応方法の決定**:
   - 質問内容に基づいて対応方法を決定します
   - 設置場所情報（例: 「客室」）から、対応が必要なエリアを推測できます
   - 時刻情報から、対応の緊急度を判断できます

3. **ゲストへの案内**:
   - システム内での直接返信機能は未実装のため、以下の方法で対応します:
     - ゲストが再度QRコードを読み取って確認する（スタッフ不在時間帯にエスカレーションされた場合、自動返信メッセージが送信済み）
     - 館内放送や掲示板で案内する
     - 施設の連絡先（電話、メール）を案内する

4. **対応完了**:
   - 対応完了後、「対応済み」としてマークします
   - 対応済みにした質問は、統計情報の「対応済み」にカウントされます

**スタッフ不在時間帯の自動返信**:
- スタッフ不在時間帯にエスカレーションされた場合、自動返信メッセージが送信されます
- 内容: 「お問い合わせありがとうございます。明朝9時までにスタッフよりご連絡いたします。緊急の場合は119（救急・消防）または110（警察）へお電話ください。」（日本語/英語対応）
- ゲストは、この自動返信メッセージを確認して、対応を待つことができます

**エスカレーション対応時の注意点**:
- ゲストの個人情報（部屋番号、名前など）は把握できません
- 会話内容、設置場所、時刻などの情報を活用して対応してください
- 緊急の場合は、館内放送や掲示板で案内することを推奨します`
      }
    ]
  },
  {
    id: 'guest',
    title: '第9章 ゲスト側の使い方（管理者向け説明）',
    subsections: [
      {
        id: 'guest-flow',
        title: '9.1 ゲストの利用フロー',
        content: `**ゲストの利用フロー**:
1. **QRコード読み取り**: ゲストがスマートフォンでQRコードを読み取ります
2. **言語選択**: 言語選択画面が表示され、ゲストが使用言語を選択します
3. **ウェルカム画面**: 施設情報、よくある質問TOP3、フリー入力フォーム、緊急連絡先が表示されます
4. **チャット画面**: ゲストが質問を入力すると、チャット画面に遷移し、AIが回答します

**ゲストができること**:
- よくある質問TOP3から質問を選択して送信
- フリー入力フォームから質問を入力して送信
- AI回答に対してフィードバック（👍👎）を送信
- スタッフに連絡ボタンでエスカレーション
- 会話引き継ぎコードで別デバイスから会話を引き継ぎ
- ダークモード切替
- ホーム画面に追加

**ゲストができないこと**:
- ログインや登録は不要（匿名で利用可能）
- 個人情報（部屋番号、名前など）の入力は不要`
      },
      {
        id: 'guest-language',
        title: '9.2 言語選択画面',
        content: `**言語選択画面の表示**:
- QRコードを読み取ると、最初に言語選択画面が表示されます
- 画面には「言語を選択してください / Please select your language」というメッセージが表示されます

**利用可能な言語**:
- プランに応じて複数言語が利用可能になります

**言語選択の方法**:
- 言語カードをクリックすると、選択した言語でウェルカム画面に遷移します
- 選択した言語は、その後の会話で使用されます

**言語選択画面の特徴**:
- レスポンシブデザイン対応（スマートフォン、タブレット、PC）
- ダークモード対応`
      },
      {
        id: 'guest-welcome',
        title: '9.3 ウェルカム画面',
        content: `**ウェルカム画面の構成**:
- **施設情報ヘッダー**: 施設名、電話番号、メールアドレス、チェックイン/アウト時間
- **よくある質問TOP3**: 管理者が登録したFAQから、よく使われる質問TOP3が表示されます
- **フリー入力フォーム**: ゲストが自由に質問を入力できます
- **緊急連絡先**: 緊急時の連絡先（119、110）が表示されます

**よくある質問TOP3の使い方**:
- ゲストが質問カードをクリックすると、チャット画面に遷移して質問が送信されます
- よくある質問TOP3は、管理者が登録したFAQから自動的に選ばれます

**フリー入力フォームの使い方**:
- ゲストが質問を入力して送信すると、チャット画面に遷移して質問が送信されます
- メッセージは1文字以上1000文字以内で入力できます

**緊急連絡先の表示**:
- 緊急時の連絡先（119、110）が表示されます
- ゲストが緊急時に適切な連絡先を確認できます

**ウェルカム画面の特徴**:
- レスポンシブデザイン対応
- ダークモード対応
- オフライン時はエラーメッセージが表示されます`
      },
      {
        id: 'guest-chat',
        title: '9.4 チャット画面',
        content: `**チャット画面の構成**:
- **ヘッダー**: 施設名、戻るボタン、トークン統合ボタン、ダークモード切替、スタッフに連絡ボタン
- **会話引き継ぎコード表示**: 現在のセッションの会話引き継ぎコードが表示されます
- **メッセージリスト**: ゲストとAIのメッセージが時系列順に表示されます
- **メッセージ入力欄**: 固定フッターにメッセージ入力欄が表示されます

**メッセージの表示**:
- ゲストのメッセージは右側に表示されます
- AIのメッセージは左側に表示されます
- 各メッセージには送信時刻が表示されます

**フィードバック機能**:
- AI回答の下に「役に立ちましたか？ / Was this helpful?」と表示されます
- ゲストは👍（役に立った）または👎（役に立たなかった）を選択できます
- フィードバックは1回のみ送信できます

**エスカレーション機能**:
- ヘッダーの「スタッフに連絡 / Contact Staff」ボタンをクリックすると、エスカレーションが作成されます
- エスカレーションが作成されると、管理画面の「未解決のエスカレーション」に表示されます
- スタッフ不在時間帯の場合は、スタッフ不在時間帯対応キューに追加されます

**会話引き継ぎコード機能**:
- ヘッダーの「トークン統合 / Link」ボタンをクリックすると、会話引き継ぎコード入力モーダルが表示されます
- 会話引き継ぎコードを入力すると、別デバイスから会話を引き継げます
- 会話引き継ぎコードは4桁の英数字で、10分間有効です

**チャット画面の特徴**:
- レスポンシブデザイン対応
- ダークモード対応
- オフライン時はエラーメッセージが表示されます
- メッセージ入力中は「AIが回答を生成中...」と表示されます`
      },
      {
        id: 'guest-pwa',
        title: '9.5 ホーム画面へのインストールの仕方',
        content: `**ホーム画面への追加とは**:
- ゲストは、YadOPERAをスマートフォンのホーム画面に追加できます
- ホーム画面に追加すると、アプリのように起動できます

**ホーム画面への追加方法**:
1. チャット画面で、「アプリをインストール」というメッセージが表示されます
2. 「インストール」ボタンをクリックします
3. ブラウザのインストール確認ダイアログが表示されます
4. 「インストール」または「追加」を選択します
5. ホーム画面にアイコンが追加されます

**ホーム画面に追加した後の使い方**:
- ホーム画面のアイコンをタップすると、YadOPERAが起動します
- ブラウザを開かなくても、アプリのように使えます

**ホーム画面への追加のメリット**:
- ブラウザを開かなくても、すぐにアクセスできます
- 一度アクセスしたページは、インターネット接続がない場合でも表示できます（ただし、新しい質問の送信はできません）

**メッセージが表示されない場合**:
- 既にホーム画面に追加済みの場合、メッセージは表示されません
- ブラウザがホーム画面への追加をサポートしていない場合、メッセージは表示されません

**メッセージを非表示にする**:
- 「後で」ボタンをクリックすると、メッセージが非表示になります
- 非表示にした後も、ブラウザのメニューから手動でホーム画面に追加できます`
      }
    ]
  },
  {
    id: 'troubleshooting',
    title: '第10章 トラブルシューティング',
    subsections: [
      {
        id: 'trouble-faq',
        title: '10.1 よくある質問（FAQ）',
        content: `**ログインできない場合**:
- **症状**: ログイン画面で「ログインに失敗しました。メールアドレスとパスワードを確認してください。」と表示される
- **対処法**:
  1. メールアドレスとパスワードが正しいか確認してください
  2. 大文字・小文字、スペースの有無を確認してください
  3. パスワードを再入力してください
  4. それでも解決しない場合は、ブラウザのキャッシュをクリアしてください（10.3参照）

**AIの応答が遅い場合**:
- **症状**: AIの回答が10秒以上かかる
- **対処法**:
  1. ネットワーク接続を確認してください
  2. ブラウザをリフレッシュ（再読み込み）してください
  3. 問題が続く場合は、しばらく時間をおいてから再度お試しください
  4. それでも解決しない場合は、サポートにお問い合わせください（10.4参照）

**FAQが表示されない場合**:
- **症状**: FAQ管理画面でFAQが表示されない、または追加できない
- **対処法**:
  1. ブラウザをリフレッシュ（再読み込み）してください
  2. ブラウザのキャッシュをクリアしてください（10.3参照）
  3. それでも解決しない場合は、サポートにお問い合わせください（10.4参照）

**ダッシュボードの統計が表示されない場合**:
- **症状**: ダッシュボードで統計情報が表示されない
- **対処法**:
  1. ブラウザをリフレッシュ（再読み込み）してください
  2. インターネット接続を確認してください
  3. それでも解決しない場合は、サポートにお問い合わせください（10.4参照）

**QRコードが読み取れない場合**:
- **症状**: ゲストがQRコードを読み取っても、言語選択画面が表示されない
- **対処法**:
  1. QRコードが正しく印刷されているか確認してください（7.5参照）
  2. QRコードのサイズが適切か確認してください（推奨: 10cm × 10cm以上）
  3. QRコードが汚れていないか確認してください
  4. 別のスマートフォンでテストしてください`
      },
      {
        id: 'trouble-error',
        title: '10.2 エラーメッセージ一覧',
        content: `**入力エラー**:
- **「リクエストが不正です。入力内容を確認してください。」**
  - 原因: 入力内容に誤りがあります
  - 対処法: 入力内容を確認して、正しい形式で入力してください

**認証エラー**:
- **「認証が必要です。ログインしてください。」**
  - 原因: ログインセッションが期限切れです
  - 対処法: 再度ログインしてください

- **「この操作を実行する権限がありません。」**
  - 原因: この操作を実行する権限がありません
  - 対処法: 管理者に連絡してください

**リソースエラー**:
- **「リソースが見つかりません。」**
  - 原因: 指定したリソースが存在しません
  - 対処法: URLやIDが正しいか確認してください

**ネットワークエラー**:
- **「ネットワークエラーが発生しました。接続を確認してください。」**
  - 原因: インターネット接続に問題があります
  - 対処法: インターネット接続を確認してください

- **「リクエストがタイムアウトしました。再度お試しください。」**
  - 原因: リクエストが時間内に完了しませんでした
  - 対処法: 再度お試しください

**サーバーエラー**:
- **「サーバーでエラーが発生しました。しばらく時間をおいてから再度お試しください。」**
  - 原因: サーバー側でエラーが発生しました
  - 対処法: しばらく時間をおいてから再度お試しください

- **「サービスが一時的に利用できません。しばらく時間をおいてから再度お試しください。」**
  - 原因: サービスが一時的に利用できません
  - 対処法: しばらく時間をおいてから再度お試しください

**AI処理エラー**:
- **「AI処理でエラーが発生しました。しばらく時間をおいてから再度お試しください。」**
  - 原因: AI処理中にエラーが発生しました
  - 対処法: しばらく時間をおいてから再度お試しください

**レート制限エラー**:
- **「リクエストが多すぎます。しばらく時間をおいてから再度お試しください。」**
  - 原因: 短時間にリクエストが多すぎます
  - 対処法: しばらく時間をおいてから再度お試しください`
      },
      {
        id: 'trouble-cache',
        title: '10.3 ブラウザキャッシュのクリア方法',
        content: `**ブラウザキャッシュとは**:
- ブラウザが過去に表示したページの情報を保存する機能です
- キャッシュが古い場合、正しく表示されないことがあります

**Google Chromeの場合**:
1. ブラウザの右上の「⋮」（三点リーダー）をクリック
2. 「設定」を選択
3. 「プライバシーとセキュリティ」を選択
4. 「閲覧履歴データの削除」を選択
5. 「キャッシュされた画像とファイル」にチェックを入れる
6. 「データを削除」をクリック

**Mozilla Firefoxの場合**:
1. ブラウザの右上の「≡」（メニュー）をクリック
2. 「設定」を選択
3. 「プライバシーとセキュリティ」を選択
4. 「Cookieとサイトデータ」セクションで「データをクリア」をクリック
5. 「キャッシュされたウェブコンテンツ」にチェックを入れる
6. 「今すぐ削除」をクリック

**Apple Safariの場合**:
1. 「Safari」メニューから「環境設定」を選択
2. 「プライバシー」タブを選択
3. 「ウェブサイトのデータを削除」をクリック
4. 「すべて削除」をクリック

**Microsoft Edgeの場合**:
1. ブラウザの右上の「⋯」（三点リーダー）をクリック
2. 「設定」を選択
3. 「プライバシー、検索、サービス」を選択
4. 「閲覧履歴データのクリア」セクションで「今すぐクリアするデータを選択」をクリック
5. 「キャッシュされた画像とファイル」にチェックを入れる
6. 「今すぐ削除」をクリック

**キャッシュをクリアするタイミング**:
- 画面が正しく表示されない場合
- エラーメッセージが表示される場合
- ログインできない場合
- データが更新されない場合`
      },
      {
        id: 'trouble-contact',
        title: '10.4 問い合わせ方法',
        content: `**サポートへの問い合わせ**:
- 上記の対処法を試しても解決しない場合は、サポートにお問い合わせください

**問い合わせ時に必要な情報**:
- 発生している問題の詳細
- エラーメッセージの内容（表示されているメッセージをそのままお知らせください）
- 使用しているブラウザの種類とバージョン
- 問題が発生した日時
- 問題が発生する前に行った操作

**問い合わせ方法**:
- メール: support@yadopera.com
- 問い合わせフォーム: （今後実装予定）

**問い合わせ時の注意点**:
- エラーメッセージは、そのままコピーして送信してください
- スクリーンショットがあると、問題の特定が早くなります
- 問題が発生する前に行った操作を詳しくお知らせください`
      }
    ]
  },
  {
    id: 'best-practices',
    title: '第11章 運用のベストプラクティス',
    subsections: [
      {
        id: 'practice-checklist',
        title: '11.1 初期設定チェックリスト',
        content: `**初期設定の流れ**:
1. **施設設定の確認**（第6章参照）
   - 施設名、メールアドレス、電話番号、住所が正しく入力されているか
   - WiFi SSID、WiFiパスワードが正しく入力されているか
   - チェックイン/アウト時間が正しく設定されているか
   - 館内ルール、周辺情報が入力されているか
   - スタッフ不在時間帯が正しく設定されているか

2. **FAQの登録**（第4章参照）
   - 基本情報のFAQ（チェックイン/アウト時間、WiFi情報など）を登録
   - 設備・サービスのFAQ（キッチン、シャワー、洗濯機など）を登録
   - 場所・アクセスのFAQ（最寄り駅、コンビニ、レストランなど）を登録
   - トラブル対応のFAQ（鍵紛失、WiFi不通、設備故障など）を登録
   - 各FAQの優先度を適切に設定（よく聞かれる質問ほど高く設定）

3. **QRコードの発行**（第7章参照）
   - 各設置場所（入口、客室、キッチン、ラウンジなど）のQRコードを生成
   - QRコードを印刷して、適切な場所に設置
   - QRコードが正しく読み取れるかテスト

4. **動作確認**
   - ゲスト側の画面が正しく表示されるか確認
   - AI回答が正しく生成されるか確認
   - エスカレーションが正しく動作するか確認

**初期設定のポイント**:
- FAQは、ゲストがよく聞く質問から優先的に登録してください
- QRコードは、ゲストがアクセスしやすい場所に設置してください
- スタッフ不在時間帯は、実際の運営時間に合わせて設定してください`
      },
      {
        id: 'practice-daily',
        title: '11.2 日次運用',
        content: `**毎日確認すべき項目**:
1. **ダッシュボードの確認**（第3章参照）
   - リアルタイムチャット履歴を確認し、ゲストの質問内容を把握
   - 未解決のエスカレーションを確認し、必要に応じて対応

2. **スタッフ不在時間帯対応キューの確認**（第5章参照）
   - スタッフ不在時間帯にエスカレーションされた質問を確認
   - 対応が必要な質問に「対応済み」としてマーク
   - 必要に応じて、ゲストに直接連絡

3. **エスカレーション対応**
   - 未解決のエスカレーションを確認
   - 会話詳細画面で質問内容を確認
   - 必要に応じて、ゲストに直接連絡

**日次運用のポイント**:
- 毎日定期的にダッシュボードを確認し、ゲストの質問傾向を把握してください
- エスカレーションされた質問は、できるだけ早く対応してください
- スタッフ不在時間帯対応キューは、フロントオープン時に確認してください`
      },
      {
        id: 'practice-weekly',
        title: '11.3 週次運用',
        content: `**毎週確認すべき項目**:
1. **週次サマリーの確認**（第3章参照）
   - 過去7日間の総質問数を確認
   - 自動応答率を確認し、AIの回答品質を評価
   - 平均信頼度を確認し、AIの回答精度を評価
   - カテゴリ別内訳を確認し、よく聞かれる質問の傾向を把握
   - よくある質問TOP5を確認し、FAQの改善点を検討

2. **FAQの改善**（第4章参照）
   - 未解決質問リストを確認し、新しいFAQを追加
   - 低評価回答リストを確認し、既存のFAQを改善
   - FAQの優先度を見直し、よく聞かれる質問ほど高く設定

3. **未解決質問の確認**
   - 未解決のエスカレーションを確認
   - 対応が必要な質問に「対応済み」としてマーク
   - よく聞かれる質問は、FAQに追加を検討

**週次運用のポイント**:
- 週次サマリーを確認し、ゲストの質問傾向を分析してください
- 未解決質問や低評価回答から、FAQ改善のヒントを得てください
- よく聞かれる質問は、FAQに追加してAIの回答品質を向上させてください`
      },
      {
        id: 'practice-monthly',
        title: '11.4 月次運用',
        content: `**毎月確認すべき項目**:
1. **月次統計の確認**（第3章参照）
   - 月次統計の「今月の質問数」を確認し、利用状況を把握
   - 月次統計の「AI自動応答数」を確認し、自動化率を評価
   - 月次統計の「未解決のエスカレーション」を確認し、対応状況を評価
   - プランの利用上限に近づいていないか確認

2. **FAQの見直し**（第4章参照）
   - 使用されていないFAQを削除または無効化
   - 古いFAQの内容を更新
   - よく聞かれる質問のFAQを追加
   - FAQの優先度を見直し

3. **サービス改善の検討**
   - ゲストの質問傾向を分析し、サービス改善のヒントを得る
   - エスカレーションが多い質問のカテゴリを特定し、FAQを充実させる
   - 低評価回答が多いFAQを特定し、内容を改善

**月次運用のポイント**:
- 月次統計を確認し、サービスの利用状況を把握してください
- FAQの見直しを行い、AIの回答品質を向上させてください
- ゲストの質問傾向を分析し、サービス改善に活用してください`
      }
    ]
  },
  {
    id: 'appendix',
    title: '第12章 付録',
    subsections: [
      {
        id: 'appendix-glossary',
        title: '12.1 用語集',
        content: `**FAQ（よくある質問）**:
- ゲストがよく聞く質問とその回答を登録したデータベース
- AIがゲストの質問に対して、FAQから適切な回答を検索して返答します

**エスカレーション**:
- AIが回答できない質問や、緊急度の高い質問をスタッフに引き継ぐ機能
- エスカレーションされた質問は、管理画面の「未解決のエスカレーション」に表示されます

**セッションID**:
- ゲストとAIの会話を識別するための一意のID
- ゲストがQRコードを読み取ると、自動的にセッションIDが生成されます

**会話引き継ぎコード**:
- 別デバイスから会話を引き継ぐための4桁の英数字コード
- 10分間有効で、ゲストが別デバイスから同じ会話を続けることができます

**スタッフ不在時間帯**:
- スタッフが不在で、ゲストの質問に対応できない時間帯
- スタッフ不在時間帯にエスカレーションされた質問は、スタッフ不在時間帯対応キューに追加されます

**信頼度**:
- AIが回答を生成する際の信頼度スコア（0%〜100%）
- 信頼度が低い場合、エスカレーションされることがあります

**自動応答率**:
- AIが自動で回答した質問の割合（パーセンテージ）
- 自動応答率が高いほど、スタッフの対応負荷が軽減されます

**月次統計**:
- 請求期間（契約開始日から1ヶ月間）の利用状況を集計した統計
- 質問数、AI自動応答数、未解決のエスカレーション数などが表示されます

**プラン**:
- 料金プランのこと
- Free、Mini、Small、Standard、Premiumの5種類があります
- プランによって、FAQ登録数上限、対応言語数、質問数上限が異なります`
      },
      {
        id: 'appendix-translation',
        title: '12.2 翻訳手引書（宿泊施設管理者向けFAQ翻訳ガイド）',
        content: `**翻訳手引書とは**:
- この手引書は、宿泊中のゲストからの質問に回答するFAQを、正確に多言語翻訳するための実務ガイドです
- AIや翻訳ツールを使ったことがない方でも、迷わず運用できる実務マニュアルとして作成しています
- ChatGPTを使用して、FAQの質問文と回答文を複数言語に翻訳する手順を説明します

**このシステムの目的**:
- 目的: 宿泊中のゲストからの質問に、正確かつ誤解なく回答すること
- 翻訳対象は、「ゲストからの質問」と「その回答」のセットです

**翻訳対象言語について**:
- 本システムは複数言語に対応可能です
- 例として「英語」と「繁体中国語」を使用しますが、実際の運用では他言語（韓国語・フランス語など）にも同じ手順を適用できます

**基本構成（必ず「質問 → 回答」の順で作成）**:
- FAQを登録する際は、必ず質問と回答をセットで管理してください
- 回答だけを書く運用はNGです

**正しい形式の例**:
- 質問（日本語）: 「朝食は何時から何時まで利用できますか？」
- 回答（日本語）: 「朝食は午前7時から午前9時まで提供しています。」

💡 **ポイント**: 質問と回答を必ずセットで管理することで、翻訳時の誤解を防げます

**翻訳前の準備（翻訳品質を左右します）**:

**日本語の質問・回答を整える**:
- 良い例:
  - Q. 消灯時間は何時ですか？
  - A. 消灯時間は午後11時です。
- 悪い例:
  - 夜って何時くらいに電気消す感じですか？
  - だいたいそのへんです。

**注意点**:
- 1文を短くする
- 曖昧な言葉を使わない
- 数字・時間・場所を明確にする

**ChatGPTで翻訳する手順（初心者向け）**:

**Step 1：ChatGPTにアクセス**:
- https://chat.openai.com/ をブラウザで開く
- メールアドレスとパスワードでログインします

**Step 2：翻訳用テンプレートを入力**:
- 以下のテンプレートをコピーして、ChatGPTに貼り付けてください

\`\`\`
あなたは宿泊施設向けの翻訳担当者です。
以下の「ゲストからの質問」と「回答」を、
意味を変えずに自然な◯◯語と◯◯語に翻訳してください。
宿泊中のゲストに向けた丁寧で分かりやすい表現にしてください。

【質問】
（ここに日本語の質問を貼る）

【回答】
（ここに日本語の回答を貼る）
\`\`\`

⚠️ **注意**: ◯◯語の部分は、必要な言語名（英語・中国語・韓国語など）に書き換えてください

**翻訳入力例（正しい例）**:

**日本語（質問）**:
\`\`\`
朝食は何時から何時まで利用できますか？
\`\`\`

**日本語（回答）**:
\`\`\`
朝食は午前7時から午前9時まで提供しています。
\`\`\`

**ChatGPTへの入力例**:
\`\`\`
あなたは宿泊施設向けの翻訳担当者です。
以下の質問と回答を英語と繁体中国語に翻訳してください。
宿泊中のゲストにとって自然で丁寧な表現にしてください。

【質問】
朝食は何時から何時まで利用できますか？

【回答】
朝食は午前7時から午前9時まで提供しています。
\`\`\`

**翻訳結果の理想例**:

**英語**:
- Q. What time is breakfast served?
- A. Breakfast is served from 7:00 AM to 9:00 AM.

**繁体中国語（Traditional Chinese）**:
- Q. 早餐供應時間是幾點到幾點？
- A. 早餐供應時間為上午7點至上午9點。

**翻訳の確認方法（外国語が分からない人向け）**:

**ChatGPTで「逆翻訳」して確認する**:

**手順**:
1. 翻訳された英文・中国語をコピーします
2. ChatGPTに以下を入力します

\`\`\`
以下の文章を日本語に戻して意味を確認してください。
（ここに翻訳文を貼る）
\`\`\`

**チェックポイント**:
- 日本語に戻した意味が元の質問・回答と一致しているか
- 時間・金額・条件が変わっていないか

**数字・時間・固有名詞を重点確認**:

| 項目 | 確認内容 |
|---|---|
| 時間 | 7:00 → 9:00 になっていないか |
| 料金 | 無料 → 有料 に変わっていないか |
| 禁止事項 | OK → NG に変わっていないか |

**不安な場合の再指示テンプレート**:
\`\`\`
元の日本語の意味と完全に一致しているか確認し、
ズレがあれば修正してください。
\`\`\`

**よくある失敗と防止策**:

| 失敗 | 防止策 |
|---|---|
| 意味が変わる | 逆翻訳で確認 |
| 丁寧さ不足 | 「丁寧に修正」と再指示 |
| 宿泊業に不自然 | 「ホテル案内向けに修正」と指示 |

**人による確認とは「外注」ではありません**:

**本システムの想定**:
- 翻訳会社に外注する前提ではありません
- 施設スタッフが意味確認する運用です

**確認方法（現実的）**:
- ChatGPTで逆翻訳
- 数字・条件のチェック
- 社内の日本語理解者が確認

💡 **ポイント**: Premiumで言語数が増えても、外注は不要です

**最初に読む簡単クイック手順（初心者向け）**:

**3ステップだけ**:
1. 日本語で「質問」と「回答」を正しく書く
2. テンプレートをコピペしてChatGPTに翻訳依頼
3. 逆翻訳で意味がズレていないか確認

**まとめ**:
この手引書の目的は、「宿泊中のゲストの質問に、正しく答える翻訳を誰でも作れるようにすること」です。

質問と回答の順序を守り、逆翻訳で確認すれば、AI初心者でも安全に多言語FAQを作成できます。`
      },
      {
        id: 'appendix-flow',
        title: '12.3 画面遷移図',
        content: `**管理画面の画面遷移**:
1. **ログイン画面** (\`/admin/login\`)
   - メールアドレスとパスワードでログイン
   - ログイン後、ダッシュボードに遷移

2. **ダッシュボード** (\`/admin/dashboard\`)
   - 週次サマリー、月次統計、リアルタイムチャット履歴、未解決のエスカレーションを表示
   - 各セクションから詳細画面に遷移可能

3. **FAQ管理** (\`/admin/faqs\`)
   - FAQの一覧表示、追加、編集、削除
   - 未解決質問リスト、低評価回答リストを表示

4. **スタッフ不在時間帯対応キュー** (\`/admin/overnight-queue\`)
   - スタッフ不在時間帯にエスカレーションされた質問を表示
   - 対応済みとしてマーク可能

5. **QRコード発行** (\`/admin/qr-code\`)
   - QRコードの生成、ダウンロード、管理

6. **ご利用マニュアル** (\`/admin/manual\`)
   - 本マニュアルを表示

7. **会話詳細** (\`/admin/conversations/:session_id\`)
   - 会話履歴の詳細を表示
   - ダッシュボードから遷移

8. **施設設定** (\`/admin/facility/settings\`)
   - 施設情報、WiFi情報、チェックイン/アウト時間、館内ルール、周辺情報、スタッフ不在時間帯を設定

**ゲスト側の画面遷移**:
1. **言語選択画面** (\`/f/:facilityId\`)
   - QRコードを読み取ると表示
   - 使用言語を選択

2. **ウェルカム画面** (\`/f/:facilityId/welcome\`)
   - 施設情報、よくある質問TOP3、フリー入力フォーム、緊急連絡先を表示
   - よくある質問をクリック、または質問を入力すると、チャット画面に遷移

3. **チャット画面** (\`/f/:facilityId/chat\`)
   - ゲストとAIの会話を表示
   - メッセージ入力、フィードバック、エスカレーション機能`
      },
      {
        id: 'appendix-template',
        title: '12.4 FAQ初期テンプレート例',
        content: `**FAQ初期テンプレートとは**:
- 新規施設登録時に自動的に登録されるFAQテンプレートです
- 20件のFAQテンプレートが初期自動登録されます
- プランによって対応言語が異なります（Freeプランは日本語のみ、Miniプラン以上は日本語・英語対応）
- 各FAQは、施設の状況に合わせて編集・削除できます

**カテゴリ別FAQテンプレート**:

**基本情報（Basic）** - 8問:
- 夜間の静音ルール
- 館内での喫煙ルール
- 共用スペースの利用
- 他のゲストの部屋への立ち入り
- 館内での飲酒
- 滞在中の問い合わせ方法
- チェックアウト前の準備
- シーツ類とバスタオルの返却

**設備・サービス（Facilities）** - 10問:
- シャワーの利用時間
- ドライヤーの場所
- 共用キッチンの利用
- 冷蔵庫の利用
- 洗濯機と乾燥機の使い方
- エアコンの温度調整
- WiFi接続
- WiFiの速度
- オンライン会議
- 変換プラグ

**場所・アクセス（Location）** - 6問:
- 近くのコンビニ
- 夜遅くまで営業している飲食店
- ATM
- 薬局やドラッグストア
- タクシーの利用
- 最寄り駅までの行き方

**トラブル対応（Trouble）** - 6問:
- 部屋の鍵が開かない
- 鍵を部屋に置いたまま外に出た
- 水やお湯が出ない
- 照明やエアコンが動かない
- 他のゲストの行動が気になる
- 体調が悪いが緊急ではない

**FAQテンプレートの活用方法**:
- 初期テンプレートは、施設の状況に合わせて編集してください
- 不要なFAQは削除できます
- 追加のFAQを登録して、より充実したFAQデータベースを構築してください`
      },
      {
        id: 'appendix-history',
        title: '12.5 更新履歴',
        content: `**2025年1月**:
- 初版公開
- 第1章〜第12章を実装

**2026年2月**:
- 第12章付録に「12.2 翻訳手引書（宿泊施設管理者向けFAQ翻訳ガイド）」を追加
- 既存の12.2〜12.4を12.3〜12.5に繰り下げ

**今後の更新予定**:
- 機能追加に伴う更新
- 改善提案に基づく内容の見直し
- 誤字・脱字の修正

**更新履歴の確認方法**:
- 本マニュアルの「12.5 更新履歴」セクションで確認できます
- 更新がある場合は、このセクションに追記されます`
      }
    ]
  }
])

onMounted(() => {
  // 初期化処理（必要に応じて）
})
</script>

<style scoped>
.manual-container {
  @apply w-full;
}
</style>

