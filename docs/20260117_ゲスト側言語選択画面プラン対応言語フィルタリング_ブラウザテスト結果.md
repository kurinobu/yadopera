# ゲスト側言語選択画面プラン対応言語フィルタリング - ブラウザテスト結果

**作成日時**: 2026年01月17日  
**目的**: ゲスト側の言語選択画面でプランに応じた言語フィルタリングのブラウザテスト結果記録  
**状態**: 📋 **テスト準備完了・テスト実行待ち**

---

## 1. テスト環境

### 1.1 Docker環境

**状態**: ✅ 正常起動

| サービス | 状態 | ポート |
|---------|------|--------|
| Backend | Up | 8000 |
| Frontend | Up | 5173 |
| PostgreSQL | Up (healthy) | 5433 |
| Redis | Up (healthy) | 6379 |

### 1.2 API確認

**Backend**: ✅ 正常動作
```json
{"status":"healthy","database":"connected","redis":"connected"}
```

**Frontend**: ✅ 正常動作
```
HTTP/1.1 200 OK
```

---

## 2. テスト用施設データ

| プラン | Slug | 期待される言語 | API確認 |
|--------|------|---------------|---------|
| Free | `test-facility-free-4975ca89` | `["ja"]` | ✅ 確認済み |
| Mini | `test-facility-mini-b7695aea` | `["ja", "en"]` | ✅ 確認済み |
| Small | `test-facility-small-492548ab` | `["ja", "en", "zh-TW"]` | ✅ 確認済み |
| Standard | `test-facility-standa-4caf15b3` | `["ja", "en", "zh-TW", "fr"]` | ✅ 確認済み |
| Premium | `test-facility-premiu-9455eb18` | `["ja", "en", "zh-TW", "fr", "es", "de", "ko", "th", "vi"]` | ✅ 確認済み |

---

## 3. ブラウザテスト結果

### 3.1 テスト1: Freeプランでの言語表示確認

**URL**: `http://localhost:5173/f/test-facility-free-4975ca89`

**期待される結果**:
- APIレスポンス: `plan_type: "Free"`, `available_languages: ["ja"]`
- 言語選択画面: 英語のみが表示される（`SUPPORTED_LANGUAGES`に日本語がないため）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスに`plan_type: "Free"`が含まれている
- [ ] APIレスポンスに`available_languages: ["ja"]`が含まれている
- [ ] 言語選択画面で英語のみが表示される
- [ ] エラーメッセージが表示されない

---

### 3.2 テスト2: Miniプランでの言語表示確認

**URL**: `http://localhost:5173/f/test-facility-mini-b7695aea`

**期待される結果**:
- APIレスポンス: `plan_type: "Mini"`, `available_languages: ["ja", "en"]`
- 言語選択画面: 英語のみが表示される（`SUPPORTED_LANGUAGES`に日本語がないため）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスに`plan_type: "Mini"`が含まれている
- [ ] APIレスポンスに`available_languages: ["ja", "en"]`が含まれている
- [ ] 言語選択画面で英語のみが表示される
- [ ] エラーメッセージが表示されない

---

### 3.3 テスト3: Smallプランでの言語表示確認

**URL**: `http://localhost:5173/f/test-facility-small-492548ab`

**期待される結果**:
- APIレスポンス: `plan_type: "Small"`, `available_languages: ["ja", "en", "zh-TW"]`
- 言語選択画面: 英語のみが表示される（`SUPPORTED_LANGUAGES`に日本語・中国語がないため）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスに`plan_type: "Small"`が含まれている
- [ ] APIレスポンスに`available_languages: ["ja", "en", "zh-TW"]`が含まれている
- [ ] 言語選択画面で英語のみが表示される
- [ ] エラーメッセージが表示されない

---

### 3.4 テスト4: Standardプランでの言語表示確認

**URL**: `http://localhost:5173/f/test-facility-standa-4caf15b3`

**期待される結果**:
- APIレスポンス: `plan_type: "Standard"`, `available_languages: ["ja", "en", "zh-TW", "fr"]`
- 言語選択画面: 英語のみが表示される（`SUPPORTED_LANGUAGES`に他の言語がないため）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスに`plan_type: "Standard"`が含まれている
- [ ] APIレスポンスに`available_languages: ["ja", "en", "zh-TW", "fr"]`が含まれている
- [ ] 言語選択画面で英語のみが表示される
- [ ] エラーメッセージが表示されない

---

### 3.5 テスト5: Premiumプランでの言語表示確認

**URL**: `http://localhost:5173/f/test-facility-premiu-9455eb18`

**期待される結果**:
- APIレスポンス: `plan_type: "Premium"`, `available_languages: ["ja", "en", "zh-TW", "fr", "es", "de", "ko", "th", "vi"]`
- 言語選択画面: 英語のみが表示される（`SUPPORTED_LANGUAGES`に他の言語がないため）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスに`plan_type: "Premium"`が含まれている
- [ ] APIレスポンスに`available_languages: ["ja", "en", "zh-TW", "fr", "es", "de", "ko", "th", "vi"]`が含まれている
- [ ] 言語選択画面で英語のみが表示される
- [ ] エラーメッセージが表示されない

---

### 3.6 テスト6: エラーハンドリング確認

**URL**: `http://localhost:5173/f/non-existent-facility`

**期待される結果**:
- APIレスポンス: 404エラー
- エラーメッセージ: "施設情報の取得に失敗しました"
- 言語選択画面: デフォルトで英語が表示される（既存の動作を維持）

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] APIレスポンスが404エラーを返す
- [ ] エラーメッセージ「施設情報の取得に失敗しました」が表示される
- [ ] 言語選択画面でデフォルトで英語が表示される
- [ ] アプリケーションがクラッシュしない

---

### 3.7 テスト7: 言語選択時の動作確認

**URL**: `http://localhost:5173/f/test-facility-mini-b7695aea`

**期待される結果**:
- Welcome画面に遷移する
- URL: `http://localhost:5173/f/test-facility-mini-b7695aea/welcome?lang=en`

**テスト結果**: ⏳ **未実施**

**確認事項**:
- [ ] 言語選択画面で英語を選択できる
- [ ] Welcome画面に遷移する
- [ ] URLに`?lang=en`が含まれている
- [ ] Welcome画面が正常に表示される

---

## 4. テスト結果サマリー

| テスト番号 | プラン | APIレスポンス | 言語選択画面 | 結果 | 備考 |
|-----------|--------|--------------|-------------|------|------|
| テスト1 | Free | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト2 | Mini | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト3 | Small | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト4 | Standard | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト5 | Premium | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト6 | エラー | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |
| テスト7 | Mini | ⏳ 未確認 | ⏳ 未確認 | ⏳ 未実施 | |

---

## 5. 注意事項

### 5.1 現時点の制限事項

**`SUPPORTED_LANGUAGES`は英語のみ**:
- 現時点では`SUPPORTED_LANGUAGES`は英語のみのため、すべてのプランで英語のみが表示されます
- 将来的に`SUPPORTED_LANGUAGES`に他の言語が追加された場合、プランに応じた言語が正しく表示されます

**例**:
- Freeプラン: `available_languages: ["ja"]` が返されるが、`SUPPORTED_LANGUAGES`に日本語がないため、英語のみが表示される
- Miniプラン: `available_languages: ["ja", "en"]` が返されるが、`SUPPORTED_LANGUAGES`に日本語がないため、英語のみが表示される

### 5.2 テスト実行時の確認ポイント

1. **ブラウザの開発者ツール（F12）を開く**
   - NetworkタブでAPIリクエストを確認
   - Consoleタブでエラーメッセージを確認

2. **APIレスポンスの確認**
   - `/api/v1/facility/{slug}`のレスポンスに`plan_type`と`available_languages`が含まれているか確認

3. **言語選択画面の確認**
   - 表示されている言語が正しいか確認
   - エラーメッセージが表示されていないか確認

---

## 6. テスト実行手順

### 6.1 準備

1. Docker環境が正常に起動していることを確認
2. ブラウザの開発者ツール（F12）を開く
3. NetworkタブとConsoleタブを開く

### 6.2 テスト実行

1. **テスト1-5**: 各プランのURLにアクセスし、以下を確認
   - APIレスポンスに`plan_type`と`available_languages`が含まれている
   - 言語選択画面が正常に表示される
   - エラーメッセージが表示されない

2. **テスト6**: 存在しない施設のURLにアクセスし、以下を確認
   - エラーメッセージが表示される
   - デフォルトで英語が表示される

3. **テスト7**: MiniプランのURLにアクセスし、以下を確認
   - 言語選択画面で英語を選択できる
   - Welcome画面に遷移する

### 6.3 結果記録

各テストの結果を上記のテーブルに記録してください。

---

**Document Version**: v1.0  
**Author**: Auto (AI Assistant)  
**Last Updated**: 2026年01月17日  
**Status**: 📋 **テスト準備完了・テスト実行待ち**

