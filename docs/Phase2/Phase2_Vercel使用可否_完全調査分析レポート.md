# Phase 2: Vercel使用可否 完全調査分析レポート

**作成日**: 2025年12月13日  
**作成者**: Auto (AI Assistant)  
**目的**: Vercelの使用可否を完全に調査分析し、正しいデプロイ先を特定する

---

## 1. 調査結果の要約

### 1.1 結論

**❌ Vercelは使用しない**

**理由**:
1. **Phase 0でVercelの運用問題が発生**（2025-11-27）
2. **Vercelは二度と使わないと継承したサービス**（2025-11-28決定）
3. **アーキテクチャ設計書ではVercelは明記されていない**（Static Siteと記載のみ）
4. **正しいデプロイ先はRender.com Static Site**（Phase 1引き継ぎ書で決定）

---

## 2. 詳細調査結果

### 2.1 Phase 0でのVercelの運用問題

**文書**: `docs/Phase0/Phase0_ホスティングサービス選択_反省と分析.md`

**問題点**:
1. **自動デプロイが機能しない**
   - GitHubへのプッシュ後、自動デプロイがトリガーされない
   - 手動デプロイが必要

2. **CLIログインが複雑**
   - ブラウザ認証が必要
   - デバイス認証コードの入力が必要
   - 時間がかかる

3. **デプロイプロセスが不明確**
   - どのコミットがデプロイされているか分かりにくい
   - デプロイログが分かりにくい

4. **時間の浪費**
   - Google Analytics設定だけで数時間を費やしている
   - 本来の開発に集中できない

**結果**: GitHub Pagesに移行（2025-11-27）

---

### 2.2 Vercelは二度と使わないと継承した決定

#### 2.2.1 Phase 1引き継ぎ書での決定

**文書**: `docs/Phase1/Phase1_引き継ぎ書.md`（2025-11-28決定）

**記載内容**:
```markdown
### 11.2 Vercelは今後使用しない

**理由**:
- 既存のRender.com Pro契約を活用
- バックエンドとフロントエンドを同一プラットフォームで管理
- 過去にVercelで設定に失敗した経験がある
```

**デプロイ戦略**:
- **バックエンド**: Render.com Pro（Web Service）
- **フロントエンド**: Render.com Static Site（新規追加予定）
- **データベース**: Railway Hobby PostgreSQL（ステージング）、Render.com Managed PostgreSQL（本番）
- **Redis**: Railway Hobby Redis（ステージング）、Redis Cloud（本番）
- **ランディングページ**: GitHub Pages（既に移行済み）

#### 2.2.2 Phase 1 Week 4実装状況での決定

**文書**: `docs/Phase1/Phase1_Week4_実装状況.md`（2025-11-28決定）

**記載内容**:
```markdown
### Vercelは今後使用しない
- **理由**:
  - 既存のRender.com Pro契約を活用
  - バックエンドとフロントエンドを同一プラットフォームで管理
  - 過去にVercelで設定に失敗した経験がある
- **フロントエンドホスティング**: Render.com Static Siteを使用
- **ランディングページ**: GitHub Pagesを使用（既に移行済み）
```

---

### 2.3 アーキテクチャ設計書の確認

**文書**: `docs/Architecture/やどぺら_v0.3_アーキテクチャ設計書.md`

**確認結果**:
- ✅ フロントエンドは「Static Site (Vue.js)」と記載されている
- ❌ Vercelとは明記されていない
- ⚠️ ランディングページのデプロイ先として「Vercel予定」と記載されているが、これはPhase 0のランディングページ用であり、フロントエンドアプリ用ではない

**デプロイメントセクション（9358行目）**:
```markdown
- ⏳ デプロイ（Vercel予定）
- デプロイ: Vercel予定（カスタムドメイン: yadopera.com）
```

**注**: これはランディングページ（Phase 0）のデプロイ先であり、フロントエンドアプリ（Phase 1以降）のデプロイ先ではない。

---

### 2.4 正しいデプロイ先の確認

#### 2.4.1 フロントエンドアプリ（Phase 1以降）

**正しいデプロイ先**: **Render.com Static Site**

**根拠**:
1. Phase 1引き継ぎ書で決定（2025-11-28）
2. バックエンドと同じプラットフォームで統一
3. 既存のRender.com Pro契約を活用

**文書**: 
- `docs/Phase1/Phase1_引き継ぎ書.md`（11.2節）
- `docs/Phase1/Phase1_Week4_実装状況.md`（重要な方針決定）

#### 2.4.2 ランディングページ（Phase 0）

**正しいデプロイ先**: **GitHub Pages**

**根拠**:
1. Vercelから移行済み（2025-11-27）
2. Phase 1引き継ぎ書で確認済み

**文書**: 
- `docs/Phase0/Phase0_ステップ10-7_GitHubPages移行_実行手順.md`
- `docs/Phase1/Phase1_引き継ぎ書.md`（11.1節）

---

## 3. 問題の特定

### 3.1 修正案1の問題点

**問題**: 修正案1でVercelへのデプロイを推奨していた

**原因**:
1. `.github/workflows/staging-deploy.yml`にVercelへのデプロイ設定があった
2. 古いドキュメント（`docs/Deployment/ステージング環境構築手順.md`）にVercelが記載されていた
3. Phase 1引き継ぎ書での決定を確認していなかった

**影響**:
- Vercelは使用しないという決定に反する
- 過去の失敗経験を無視している
- 大原則（統一・同一化）に反する

---

### 3.2 正しい修正案

**修正案**: **Render.com Static Siteへのデプロイ**（修正案2）

**理由**:
1. ✅ Phase 1引き継ぎ書で決定済み
2. ✅ バックエンドと同じプラットフォームで統一
3. ✅ 既存のRender.com Pro契約を活用
4. ✅ 過去の失敗経験を踏まえた正しい選択

---

## 4. 大原則への準拠評価

### 4.1 修正案1（Vercel）の評価

**大原則**:
1. **根本解決 > 暫定解決**: ❌ 過去の失敗経験を無視
2. **シンプル構造 > 複雑構造**: ⚠️ Vercelは複雑な設定が必要
3. **統一・同一化 > 特殊独自**: ❌ バックエンドと異なるプラットフォーム
4. **具体的 > 一般**: ✅ 具体的な手順を提示
5. **急がば回れ < 安全/確実**: ❌ 過去の失敗経験を無視

**評価**: ❌ **大原則に反する**

### 4.2 修正案2（Render.com Static Site）の評価

**大原則**:
1. **根本解決 > 暫定解決**: ✅ 過去の失敗経験を踏まえた根本的解決
2. **シンプル構造 > 複雑構造**: ✅ バックエンドと同じプラットフォームでシンプル
3. **統一・同一化 > 特殊独自**: ✅ バックエンドと同じプラットフォームで統一
4. **具体的 > 一般**: ✅ 具体的な手順を提示
5. **急がば回れ < 安全/確実**: ✅ 過去の失敗経験を踏まえた安全な選択

**評価**: ✅ **大原則に準拠**

---

## 5. 推奨される修正

### 5.1 即座に実施すべき修正

1. **修正案1の撤回**
   - `docs/Deployment/Vercel_ステージング環境デプロイ手順.md`を削除または修正
   - `docs/Phase2/Phase2_ステージング環境テスト準備_完全調査分析.md`の修正案1を修正案2に変更

2. **修正案2（Render.com Static Site）の実施**
   - `docs/Deployment/Render_Railway_手動設定_実行手順.md`の手順に従う
   - Render.com Static Siteでフロントエンドをデプロイ

3. **GitHub Actionsの設定修正**
   - `.github/workflows/staging-deploy.yml`のVercelデプロイ設定を削除またはコメントアウト
   - Render.com Static Siteへの自動デプロイ設定を追加（必要に応じて）

4. **render.yamlの修正**
   - `render.yaml`にStatic Siteの設定を追加（必要に応じて）

---

## 6. 参考資料

### 6.1 決定文書

- `docs/Phase1/Phase1_引き継ぎ書.md`（11.2節: Vercelは今後使用しない）
- `docs/Phase1/Phase1_Week4_実装状況.md`（重要な方針決定）
- `docs/Phase0/Phase0_ホスティングサービス選択_反省と分析.md`（Vercelの運用問題）

### 6.2 デプロイ手順

- `docs/Deployment/Render_Railway_手動設定_実行手順.md`（ステップ5: フロントエンド設定）
- `docs/Deployment/ステージング環境構築手順.md`（ステップ5: フロントエンド設定）

### 6.3 アーキテクチャ設計書

- `docs/Architecture/やどぺら_v0.3_アーキテクチャ設計書.md`（デプロイメントセクション）

---

## 7. まとめ

### 7.1 調査結果

1. **Vercelは使用しない**: Phase 1引き継ぎ書で決定済み（2025-11-28）
2. **正しいデプロイ先**: Render.com Static Site
3. **修正案1は誤り**: Vercelへのデプロイを推奨していた
4. **修正案2が正しい**: Render.com Static Siteへのデプロイ

### 7.2 次のステップ

1. **修正案1の撤回と修正案2の実施**
2. **GitHub Actionsの設定修正**
3. **render.yamlの確認・修正**
4. **Render.com Static Siteでのデプロイ実施**

---

**結論**: **Vercelは使用せず、Render.com Static Siteを使用する**

