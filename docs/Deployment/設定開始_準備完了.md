# Render.comとRailway手動設定 準備完了

**作成日**: 2025年11月28日 14:53  
**ステータス**: バックアップ完了、設定手順書作成完了

---

## ✅ 完了した作業

1. **バックアップ作成**
   - バックアップディレクトリ: `docs/Backups/20251128_145259_deployment_setup/`
   - バックアップ対象ファイル:
     - `render.yaml`
     - `railway.json`
     - `docker-compose.yml`
     - `docs/Deployment/ステージング環境構築手順.md`
     - `docs/Deployment/Render_Railway_手動設定_調査分析レポート.md`

2. **設定手順書作成**
   - `docs/Deployment/Render_Railway_手動設定_実行手順.md` - 詳細な実行手順
   - `docs/Deployment/Render_Railway_手動設定_調査分析レポート.md` - 調査分析結果

---

## 📋 次のステップ（手動設定）

以下の手順に従って、Render.comとRailwayのダッシュボードで設定を実行してください。

### 1. developブランチに切り替え（必要に応じて）

現在、未コミットの変更があるため、`develop`ブランチに切り替える前に変更をコミットまたはstashしてください。

```bash
# オプション1: 変更をコミット
git add .
git commit -m "Phase 1 Week 4: デプロイ設定準備"

# オプション2: 変更をstash
git stash

# developブランチに切り替え
git checkout develop
git pull origin develop
```

### 2. Railway Hobby設定

**詳細手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md` のステップ2を参照

1. PostgreSQLサービス追加
2. pgvector拡張有効化
3. Redisサービス追加
4. 接続URLをメモ

### 3. SECRET_KEY生成

```bash
openssl rand -hex 32
```

生成されたキーをメモしてください。

### 4. Render.com Pro設定

**詳細手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md` のステップ4を参照

1. Web Service作成
2. 環境変数設定（Railwayの接続URL、SECRET_KEY等）
3. 自動デプロイ設定
4. ヘルスチェック設定

### 5. Render.com Static Site設定

**詳細手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md` のステップ5を参照

1. Static Site作成
2. 環境変数設定
3. バックエンドのCORS設定を更新

### 6. データベースマイグレーション

**詳細手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md` のステップ6を参照

Render.comのShellから実行:
```bash
cd backend
alembic upgrade head
```

### 7. 動作確認

**詳細手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md` のステップ7を参照

1. バックエンドヘルスチェック確認
2. フロントエンド表示確認
3. CORS確認

---

## 📚 参考資料

- **実行手順**: `docs/Deployment/Render_Railway_手動設定_実行手順.md`
- **調査分析レポート**: `docs/Deployment/Render_Railway_手動設定_調査分析レポート.md`
- **ステージング環境構築手順**: `docs/Deployment/ステージング環境構築手順.md`

---

## ⚠️ 注意事項

1. **接続URL形式**: 
   - `DATABASE_URL`は`postgresql+asyncpg://`形式である必要があります
   - Railwayから取得したURLが`postgresql://`形式の場合は、`postgresql+asyncpg://`に変更してください

2. **CORS設定**:
   - フロントエンドURLを`CORS_ORIGINS`に設定してください
   - 完全なURL形式（`https://...`）である必要があります

3. **環境変数**:
   - すべての環境変数が正しく設定されているか確認してください
   - `SECRET_KEY`は32文字以上の強力なランダム文字列を使用してください

---

**準備完了**: 設定を開始できます。

