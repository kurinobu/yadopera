# 依存関係パッケージ追加 計画

**作成日**: 2025年11月29日  
**目的**: QRコード生成機能に必要な依存関係パッケージの追加計画  
**対象**: Phase 1 Week 4 ステップ6（QRコード生成API実装）

---

## 1. 現状確認

### 1.1 実装状況

**ステップ6: QRコード生成API実装**
- **完了日**: 2025-11-28
- **実装内容**: ✅ 完了済み
  - `backend/app/api/v1/admin/qr_code.py`: QRコード生成APIエンドポイント作成
  - `backend/app/services/qr_code_service.py`: `QRCodeService`クラス実装（qrcode/reportlab統合）
  - `backend/app/schemas/qr_code.py`: QRコード関連スキーマ作成
  - `backend/app/api/v1/router.py`: QRコードルーター統合
  - `frontend/src/api/qrcode.ts`: QRコード生成API呼び出し作成
  - `frontend/src/views/admin/QRCodeGenerator.vue`: API連携実装（モックから実APIへ）

**注意**: qrcode/reportlabライブラリは`requirements.txt`に追加が必要（MVP期間中はフォールバック実装あり）

---

### 1.2 現在の状態

**依存関係パッケージ**: ❌ **未追加**

**不足しているパッケージ**:
1. `qrcode[pil]>=7.4.2` - QRコード生成
2. `reportlab>=4.0.0` - PDF生成
3. `Pillow>=10.0.0` - 画像処理

**現在の動作**:
- アプリケーションは正常に起動する（try-exceptで処理されているため）
- QRコード生成機能は制限付きで動作（警告メッセージが表示される）
- PDF生成機能は利用不可

---

## 2. 追加計画

### 2.1 追加タイミング

**推奨**: **即座に追加**（ステップ6は既に完了しているため）

**理由**:
1. ステップ6の実装は既に完了している
2. 依存関係パッケージの追加が未完了の状態
3. デプロイ時に警告メッセージが表示されている
4. 機能を完全に動作させるために必要

---

### 2.2 追加するパッケージ

**追加内容**:
```txt
# QR Code Generation (Phase 1 Week 4 Step 6)
qrcode[pil]>=7.4.2  # QRコード生成
reportlab>=4.0.0  # PDF生成
Pillow>=10.0.0  # 画像処理
```

**追加位置**: `backend/requirements.txt`の最後に追加

---

### 2.3 追加後のrequirements.txt（予定）

```txt
# FastAPI
fastapi==0.109.0
uvicorn[standard]==0.27.0
python-multipart==0.0.6

# Database
sqlalchemy[asyncio]==2.0.25
alembic==1.13.1
psycopg2-binary==2.9.9
asyncpg==0.29.0
pgvector==0.2.4

# Authentication
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-dotenv==1.0.0

# OpenAI
openai==1.6.1
langchain==0.1.0
tiktoken==0.5.2

# Redis
redis==5.0.1
hiredis==2.2.3

# HTTP Client
httpx==0.25.2

# Utilities
pydantic==2.5.3
pydantic-settings==2.1.0

# Validation
email-validator==2.2.0  # Pydantic EmailStr サポート（yanked version回避）

# Timezone
pytz==2024.2  # タイムゾーン処理

# QR Code Generation (Phase 1 Week 4 Step 6)
qrcode[pil]>=7.4.2  # QRコード生成
reportlab>=4.0.0  # PDF生成
Pillow>=10.0.0  # 画像処理
```

---

## 3. 実装計画

### 3.1 追加手順

**手順**:
1. `backend/requirements.txt`を編集
2. QRコード生成セクションを追加
3. 変更をコミット・プッシュ
4. Render.comで自動再デプロイが実行されるのを待つ
5. 警告メッセージが解消されているか確認

---

### 3.2 確認項目

**追加後の確認**:
- [ ] `requirements.txt`に3つのパッケージが追加されているか
- [ ] デプロイが成功しているか
- [ ] 警告メッセージが表示されないか
- [ ] QRコード生成APIが正常に動作するか
- [ ] PDF生成機能が正常に動作するか

---

## 4. 評価

### 4.1 追加の必要性

**必須性**: **高**（ステップ6は既に完了しているため）

**理由**:
1. ステップ6の実装は既に完了している
2. 依存関係パッケージの追加が未完了の状態
3. 機能を完全に動作させるために必要
4. デプロイ時の警告メッセージを解消するため

---

### 4.2 追加タイミング

**推奨**: **即座に追加**

**理由**:
1. ステップ6は既に完了している
2. 依存関係パッケージの追加が未完了の状態
3. デプロイ時に警告メッセージが表示されている
4. 機能を完全に動作させるために必要

---

## 5. まとめ

### 5.1 現状

**ステップ6**: ✅ 実装完了（2025-11-28）

**依存関係パッケージ**: ❌ 未追加

**追加タイミング**: **即座に追加**（ステップ6は既に完了しているため）

---

### 5.2 追加内容

**追加パッケージ**:
1. `qrcode[pil]>=7.4.2` - QRコード生成
2. `reportlab>=4.0.0` - PDF生成
3. `Pillow>=10.0.0` - 画像処理

---

### 5.3 次のアクション

**即座に実行**:
1. `requirements.txt`に3つのパッケージを追加
2. 変更をコミット・プッシュ
3. デプロイ確認
4. 警告メッセージが解消されているか確認

---

**Document Version**: v1.0  
**Author**: Auto (AI Assistant)  
**Last Updated**: 2025-11-29  
**Status**: 追加計画完了、即座に追加推奨


